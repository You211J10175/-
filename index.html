<!DOCTYPE html>
<html>
  <head>
    <title>感情測定実験</title>
    <script src="https://unpkg.com/jspsych@7.3.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-video-button-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-button-response@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-multi-choice@1.1.2"></script>
    <script src="https://unpkg.com/@jspsych/plugin-preload@1.1.2"></script>
    <link href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css" rel="stylesheet" type="text/css" />

  </head>
  <body></body>
  <script>

//こっから
    // Glitchとの連携のための関数
    //function saveData(data){
    //    var xhr = new XMLHttpRequest();
    //    xhr.open('POST', 'https://smoggy-grizzly-megalosaurus.glitch.me/save-data');
    //    xhr.setRequestHeader('Content-Type', 'application/json');
    //    xhr.onload = function() {
    //        if(xhr.status == 200){
    //            var response = JSON.parse(xhr.responseText);
    //            console.log(response.message);
    //        }
    //    };
    //    xhr.onerror = function() {
    //        console.log("Error: " + xhr.status);
    //    }
    //    xhr.send(JSON.stringify({data: data}));
    //}

    // セットアップ。共通
    //var jsPsych = initJsPsych({
    //  on_finish: function() {
    //        saveData(jsPsych.data.get().csv());
    //        jsPsych.data.displayData();
    // }
    //});
//ここまで最後に入れ替え予定

//ここを消す    
    // セットアップ。共通
    var jsPsych = initJsPsych({
      on_finish: function() {
        jsPsych.data.displayData();
      }
    });
//ここを消す    

    // プレロード処理。提示タイプ共通
    var preload = {
      type: jsPsychPreload,
      auto_preload: true,
      images: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png',
               'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド黒_サブラベル無.png',
               ],
      video: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/49_ニュートラル.mp4',
              'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/優しさ_妹の恋人_編集済.mp4',
              'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/娯楽_メリーに首ったけ_編集済.mp4',
              'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/嫌悪_トレインスポッティング_編集済.mp4',
              'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/怒り_シンドラーのリスト_編集済.mp4',
              'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/恐怖_コピーキャット_編集済.mp4',
              'https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/悲しみ_ライフ・イズ・ビューティフル_編集済.mp4',
              ]

      
    };

    // 使用可能な2つの異なる回答尺度を定義する。質問テンプレから
    var page_1_options = ["A", "B", "C", "D", "E", "F", "G", "H", "I"];
    var page_2_options = ["1", "2", "3", "4", "5", "6", "7", "8", "9"];

    // 初期文章。動画テンプレから
    var pre_trial = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '次ページの動画で音量調節を行って下さい。',
      choices: ['次へ']
    };

    // 動画
    var trial_1 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/49_ニュートラル.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_2 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド黒_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "<p>ここには画像の説明を書く。</p>今回は黒く塗りつぶされたマスのアルファベットと数字の組み合わせ(例.A-1など)を、次のページで選択してください。",
    };    

    // 回答
    var multi_choice_block_horizontal_3 = {
      type: jsPsychSurveyMultiChoice,
      questions: [
        {prompt: "アルファベット (今回は e の列)", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字 (今回は 5 の行)", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };

    // ここでグリッド画像の感情測定が必要かもしれない、開始時の感情を測定する必要性？ いらない決定
    
    // 動画の説明文
    var trial_101 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p>次の動画の説明</p>ベニー(男)が喫茶店でバカを演じる。',
      choices: ['次へ']
    };

    // 動画
    var trial_102 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/優しさ_妹の恋人_編集済.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_103 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "現在の感情に当てはまるマスのアルファベットと数字の組み合わせを、次のページで選択してください",
    };    

    // 回答
    var multi_choice_block_horizontal_104 = {
      type: jsPsychSurveyMultiChoice,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      questions: [
        {prompt: "アルファベット", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };
    
    // 以下、「動画、画像、質問」の無限ループで行けそう

    // 動画の説明文
    var trial_201 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p>次の動画の説明</p>ベニー(男)が喫茶店でバカを演じる。',
      choices: ['次へ']
    };

    // 動画
    var trial_202 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/娯楽_メリーに首ったけ_編集済.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_203 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "現在の感情に当てはまるマスのアルファベットと数字の組み合わせを、次のページで選択してください",
    };    

    // 回答
    var multi_choice_block_horizontal_204 = {
      type: jsPsychSurveyMultiChoice,
      questions: [
        {prompt: "アルファベット", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };
    
    // 動画の説明文
    var trial_301 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p>次の動画の説明</p>ベニー(男)が喫茶店でバカを演じる。',
      choices: ['次へ']
    };

    // 動画
    var trial_302 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/嫌悪_トレインスポッティング_編集済.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_303 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "現在の感情に当てはまるマスのアルファベットと数字の組み合わせを、次のページで選択してください",
    };    

    // 回答
    var multi_choice_block_horizontal_304 = {
      type: jsPsychSurveyMultiChoice,
      questions: [
        {prompt: "アルファベット", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };
    
    // 動画の説明文
    var trial_401 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p>次の動画の説明</p>ベニー(男)が喫茶店でバカを演じる。',
      choices: ['次へ']
    };

    // 動画
    var trial_402 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/怒り_シンドラーのリスト_編集済.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_403 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "現在の感情に当てはまるマスのアルファベットと数字の組み合わせを、次のページで選択してください",
    };    

    // 回答
    var multi_choice_block_horizontal_404 = {
      type: jsPsychSurveyMultiChoice,
      questions: [
        {prompt: "アルファベット", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };
    
    // 動画の説明文
    var trial_501 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p>次の動画の説明</p>ベニー(男)が喫茶店でバカを演じる。',
      choices: ['次へ']
    };

    // 動画
    var trial_502 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/恐怖_コピーキャット_編集済.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_503 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "現在の感情に当てはまるマスのアルファベットと数字の組み合わせを、次のページで選択してください",
    };    

    // 回答
    var multi_choice_block_horizontal_504 = {
      type: jsPsychSurveyMultiChoice,
      questions: [
        {prompt: "アルファベット", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };
    
    // 動画の説明文
    var trial_601 = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p>次の動画の説明</p>ベニー(男)が喫茶店でバカを演じる。',
      choices: ['次へ']
    };

    // 動画
    var trial_602 = {
      type: jsPsychVideoButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/悲しみ_ライフ・イズ・ビューティフル_編集済.mp4'],
      choices: ['次へ'],
      margin_vertical: '10px',
      margin_horizontal: '8px',
      prompt: '再生終了したら次のページへ',
      //352*288　動画解像度
      width: 704,
      height: 576,
      autoplay: true,
      rate: 1,
      response_ends_trial: true,
    //  response_allowed_while_playing: false　//本番では有効に
    };

    // グリッド画像
    var trial_603 = {
      type: jsPsychImageButtonResponse,
      stimulus: ['https://raw.githubusercontent.com/You211J10175/experiment/refs/heads/main/感情測定グリッド_サブラベル無.png'],
      // stimulus_width: 400,
      choices: ['次へ'],
      prompt: "現在の感情に当てはまるマスのアルファベットと数字の組み合わせを、次のページで選択してください",
    };    

    // 回答
    var multi_choice_block_horizontal_604 = {
      type: jsPsychSurveyMultiChoice,
      questions: [
        {prompt: "アルファベット", name: 'アルファベット', options: page_1_options, required: true, horizontal: true,}, 
        {prompt: "数字", name: '数字', options: page_2_options, required: true, horizontal: true}
      ],
      button_label: '次へ',
    };
    

    jsPsych.run([preload, pre_trial, trial_1, trial_2, multi_choice_block_horizontal_3, trial_101, trial_102, trial_103, multi_choice_block_horizontal_104, trial_201, trial_202, multi_choice_block_horizontal_203, trial_301, trial_302, multi_choice_block_horizontal_303]);

  </script>
</html>
